<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36" version="29.0.3">
  <diagram name="Separation of Responsibilities" id="separation-diagram">
    <mxGraphModel dx="984" dy="541" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="2000" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="title" value="&lt;b&gt;&lt;font style=&quot;font-size: 24px;&quot;&gt;SeparaÃ§Ã£o de Responsabilidades&lt;/font&gt;&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="100" y="30" width="650" height="40" as="geometry" />
        </mxCell>
        <mxCell id="subtitle" value="Processo Transacional vs Relay de Eventos: Escalabilidade Independente" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=2" parent="1" vertex="1">
          <mxGeometry x="125" y="70" width="600" height="25" as="geometry" />
        </mxCell>
        <mxCell id="divider1" value="" style="endArrow=none;html=1;strokeColor=#000000;strokeWidth=2;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="70" y="120" as="sourcePoint" />
            <mxPoint x="780" y="120" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="transactional-section" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#000000;strokeColor=#000000;strokeWidth=4;" parent="1" vertex="1">
          <mxGeometry x="70" y="165" width="340" height="650" as="geometry" />
        </mxCell>
        <mxCell id="trans-title" value="&lt;b&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;PROCESSO TRANSACIONAL&lt;/font&gt;&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size: 11px;&quot;&gt;LÃ³gica de NegÃ³cio&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontColor=#ffffff;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="110" y="165" width="260" height="45" as="geometry" />
        </mxCell>
        <mxCell id="request-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#000000;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="100" y="230" width="280" height="60" as="geometry" />
        </mxCell>
        <mxCell id="request-label" value="&lt;b&gt;HTTP REQUEST&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;POST /api/orders&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="140" y="245" width="200" height="30" as="geometry" />
        </mxCell>
        <mxCell id="arrow-req-service" value="" style="endArrow=classic;html=1;strokeColor=#ffffff;strokeWidth=3;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="request-box" target="service-trans-box" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="service-trans-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#000000;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="100" y="320" width="280" height="120" as="geometry" />
        </mxCell>
        <mxCell id="service-trans-title" value="&lt;b&gt;BUSINESS SERVICE&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="140" y="330" width="200" height="20" as="geometry" />
        </mxCell>
        <mxCell id="service-trans-items" value="â€¢ ValidaÃ§Ã£o de regras de negÃ³cio&lt;br&gt;â€¢ CÃ¡lculos e transformaÃ§Ãµes&lt;br&gt;â€¢ OrquestraÃ§Ã£o de operaÃ§Ãµes&lt;br&gt;â€¢ PreparaÃ§Ã£o de dados" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=12;" parent="1" vertex="1">
          <mxGeometry x="115" y="360" width="250" height="70" as="geometry" />
        </mxCell>
        <mxCell id="arrow-service-trans" value="&lt;b&gt;BEGIN TX&lt;/b&gt;" style="endArrow=classic;html=1;strokeColor=#ffffff;strokeWidth=3;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontColor=#ffffff;fontSize=10;" parent="1" source="service-trans-box" target="transaction-box" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="transaction-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#000000;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="100" y="475" width="280" height="305" as="geometry" />
        </mxCell>
        <mxCell id="transaction-title" value="&lt;b&gt;DATABASE TRANSACTION&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="140" y="485" width="200" height="25" as="geometry" />
        </mxCell>
        <mxCell id="write1-box" value="&lt;b&gt;1. INSERT orders&lt;/b&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e0e0e0;strokeColor=#000000;strokeWidth=1;fontSize=10;align=center;" parent="1" vertex="1">
          <mxGeometry x="120" y="525" width="240" height="30" as="geometry" />
        </mxCell>
        <mxCell id="write2-box" value="&lt;b&gt;2. UPDATE inventory&lt;/b&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e0e0e0;strokeColor=#000000;strokeWidth=1;fontSize=10;align=center;" parent="1" vertex="1">
          <mxGeometry x="120" y="565" width="240" height="30" as="geometry" />
        </mxCell>
        <mxCell id="write3-box" value="&lt;b&gt;3. INSERT payment&lt;/b&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e0e0e0;strokeColor=#000000;strokeWidth=1;fontSize=10;align=center;" parent="1" vertex="1">
          <mxGeometry x="120" y="605" width="240" height="30" as="geometry" />
        </mxCell>
        <mxCell id="divider-outbox" value="" style="endArrow=none;html=1;strokeColor=#000000;strokeWidth=2;dashed=1;dashPattern=4 4;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="120" y="650" as="sourcePoint" />
            <mxPoint x="360" y="650" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="write-outbox-box" value="&lt;b&gt;4. INSERT outbox_events&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size: 8px;&quot;&gt;{event_type, payload, published=false}&lt;/font&gt;&lt;div&gt;&lt;span style=&quot;font-size: 8px;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 8px;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;div&gt;&lt;font style=&quot;font-size: 8px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 8px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 8px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#000000;strokeColor=#000000;strokeWidth=2;fontSize=10;align=center;fontColor=#ffffff;" parent="1" vertex="1">
          <mxGeometry x="120" y="660" width="240" height="90" as="geometry" />
        </mxCell>
        <mxCell id="trans-characteristics" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#000000;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="100" y="787" width="280" height="20" as="geometry" />
        </mxCell>
        <mxCell id="trans-char-title" value="&lt;b&gt;RESPONSABILIDADES&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="140" y="789" width="200" height="16" as="geometry" />
        </mxCell>
        <mxCell id="trans-char-list" value="âœ“ Garantir consistÃªncia de dados&lt;br&gt;âœ“ Validar regras de negÃ³cio&lt;br&gt;âœ“ Manter integridade referencial&lt;br&gt;âœ“ Escrever na tabela outbox&lt;br&gt;âœ“ Responder requisiÃ§Ã£o HTTP" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=8;fontColor=#ffffff;" parent="1" vertex="1">
          <mxGeometry x="160" y="690" width="250" height="15" as="geometry" />
        </mxCell>
        <mxCell id="relay-section" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#000000;strokeColor=#000000;strokeWidth=4;" parent="1" vertex="1">
          <mxGeometry x="440" y="150" width="340" height="670" as="geometry" />
        </mxCell>
        <mxCell id="relay-title" value="&lt;b&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;RELAY DE EVENTOS&lt;/font&gt;&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size: 11px;&quot;&gt;PublicaÃ§Ã£o no Kafka&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontColor=#ffffff;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="480" y="165" width="260" height="45" as="geometry" />
        </mxCell>
        <mxCell id="polling-relay-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#000000;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="470" y="230" width="280" height="90" as="geometry" />
        </mxCell>
        <mxCell id="polling-relay-title" value="&lt;b&gt;EVENT RELAY SERVICE&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size: 8px;&quot;&gt;Polling ou CDC (Debezium)&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="510" y="240" width="200" height="35" as="geometry" />
        </mxCell>
        <mxCell id="polling-loop" value="&lt;font face=&quot;Courier New&quot;&gt;while (true) {&lt;br&gt;&amp;nbsp; readPendingEvents()&lt;br&gt;&amp;nbsp; publishToKafka()&lt;br&gt;}&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=9;" parent="1" vertex="1">
          <mxGeometry x="490" y="265" width="240" height="50" as="geometry" />
        </mxCell>
        <mxCell id="read-outbox-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#000000;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="470" y="355" width="280" height="100" as="geometry" />
        </mxCell>
        <mxCell id="read-outbox-title" value="&lt;b&gt;READ OUTBOX TABLE&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="510" y="365" width="200" height="20" as="geometry" />
        </mxCell>
        <mxCell id="read-query" value="&lt;font face=&quot;Courier New&quot;&gt;SELECT * FROM outbox_events&lt;br&gt;WHERE published = false&lt;br&gt;ORDER BY created_at&lt;br&gt;LIMIT 100&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="490" y="385" width="240" height="50" as="geometry" />
        </mxCell>
        <mxCell id="arrow-read-transform" value="" style="endArrow=classic;html=1;strokeColor=#ffffff;strokeWidth=3;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="read-outbox-box" target="transform-box" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="transform-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#000000;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="470" y="485" width="280" height="80" as="geometry" />
        </mxCell>
        <mxCell id="transform-title" value="&lt;b&gt;TRANSFORM &amp; ENRICH&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="510" y="495" width="200" height="20" as="geometry" />
        </mxCell>
        <mxCell id="transform-items" value="â€¢ SerializaÃ§Ã£o (JSON, Avro, Protobuf)&lt;br&gt;â€¢ ValidaÃ§Ã£o de schema&lt;br&gt;â€¢ Adicionar metadata (timestamp, trace)&lt;br&gt;â€¢ Definir partition key" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=9;" parent="1" vertex="1">
          <mxGeometry x="485" y="510" width="250" height="40" as="geometry" />
        </mxCell>
        <mxCell id="kafka-relay-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#000000;strokeColor=#000000;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="470" y="600" width="280" height="110" as="geometry" />
        </mxCell>
        <mxCell id="kafka-relay-title" value="&lt;b&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;APACHE KAFKA&lt;/font&gt;&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontColor=#ffffff;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="510" y="595" width="200" height="25" as="geometry" />
        </mxCell>
        <mxCell id="kafka-topics" value="Topic: orders.events&lt;br&gt;Topic: payments.events&lt;br&gt;Topic: inventory.events" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;fontColor=#ffffff;" parent="1" vertex="1">
          <mxGeometry x="510" y="615" width="200" height="45" as="geometry" />
        </mxCell>
        <mxCell id="update-outbox-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#000000;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="470" y="745" width="280" height="50" as="geometry" />
        </mxCell>
        <mxCell id="update-outbox-title" value="&lt;b&gt;UPDATE OUTBOX&lt;/b&gt;&lt;br&gt;&lt;font face=&quot;Courier New&quot;&gt;SET published = true, published_at = NOW()&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="490" y="757" width="240" height="30" as="geometry" />
        </mxCell>
        <mxCell id="relay-char-list" value="âœ“ Ler eventos pendentes da outbox&lt;br&gt;âœ“ Publicar no Kafka com retry&lt;br&gt;âœ“ Garantir at-least-once delivery&lt;br&gt;âœ“ Monitorar lag de publicaÃ§Ã£o&lt;br&gt;âœ“ Lidar com falhas do Kafka" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=9;fontColor=#ffffff;" parent="1" vertex="1">
          <mxGeometry x="470" y="652" width="260" height="58" as="geometry" />
        </mxCell>
        <mxCell id="arrow-connection" value="&lt;b&gt;TABELA OUTBOX&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;Ponto de integraÃ§Ã£o&lt;/font&gt;" style="endArrow=classic;startArrow=classic;html=1;strokeColor=#000000;strokeWidth=4;exitX=0.999;exitY=0.393;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=11;fontStyle=1;exitPerimeter=0;" parent="1" source="transactional-section" target="read-outbox-box" edge="1">
          <mxGeometry x="-0.6732" y="-65" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="scaling-section" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#000000;strokeWidth=3;" parent="1" vertex="1">
          <mxGeometry x="70" y="840" width="710" height="280" as="geometry" />
        </mxCell>
        <mxCell id="scaling-title" value="&lt;b&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;ESCALABILIDADE INDEPENDENTE&lt;/font&gt;&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="225" y="855" width="400" height="30" as="geometry" />
        </mxCell>
        <mxCell id="scaling-trans-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#000000;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="100" y="905" width="320" height="190" as="geometry" />
        </mxCell>
        <mxCell id="scaling-trans-title" value="&lt;b&gt;SCALING: PROCESSO TRANSACIONAL&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="120" y="915" width="280" height="25" as="geometry" />
        </mxCell>
        <mxCell id="app-instance1" value="APP 1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e0e0e0;strokeColor=#000000;strokeWidth=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="125" y="955" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="app-instance2" value="APP 2" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e0e0e0;strokeColor=#000000;strokeWidth=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="220" y="955" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="app-instance3" value="APP 3" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e0e0e0;strokeColor=#000000;strokeWidth=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="315" y="955" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="scaling-trans-reason" value="&lt;b&gt;Escala baseado em:&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="120" y="1010" width="280" height="20" as="geometry" />
        </mxCell>
        <mxCell id="scaling-trans-list" value="â€¢ Volume de requisiÃ§Ãµes HTTP&lt;br&gt;â€¢ Complexidade das regras de negÃ³cio&lt;br&gt;â€¢ LatÃªncia de resposta desejada&lt;br&gt;â€¢ Carga na CPU e memÃ³ria&lt;div&gt;&lt;br&gt;&lt;br&gt;&lt;b&gt;MÃ©trica:&lt;/b&gt; Requests/segundo&lt;/div&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=9;" parent="1" vertex="1">
          <mxGeometry x="125" y="1030" width="270" height="55" as="geometry" />
        </mxCell>
        <mxCell id="scaling-relay-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#000000;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="440" y="905" width="320" height="190" as="geometry" />
        </mxCell>
        <mxCell id="scaling-relay-title" value="&lt;b&gt;SCALING: RELAY DE EVENTOS&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="460" y="915" width="280" height="25" as="geometry" />
        </mxCell>
        <mxCell id="relay-instance1" value="RELAY 1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e0e0e0;strokeColor=#000000;strokeWidth=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="465" y="955" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="relay-instance2" value="RELAY 2" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e0e0e0;strokeColor=#000000;strokeWidth=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="560" y="955" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="relay-instance3" value="RELAY 3" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e0e0e0;strokeColor=#000000;strokeWidth=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="655" y="955" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="scaling-relay-reason" value="&lt;b&gt;Escala baseado em:&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="460" y="1010" width="280" height="20" as="geometry" />
        </mxCell>
        <mxCell id="scaling-relay-list" value="â€¢ Volume de eventos na outbox&lt;br&gt;â€¢ Lag de publicaÃ§Ã£o no Kafka&lt;br&gt;â€¢ Throughput desejado de eventos&lt;br&gt;â€¢ Taxa de escrita no Kafka&lt;div&gt;&lt;br&gt;&lt;br&gt;&lt;b&gt;MÃ©trica:&lt;/b&gt; Eventos/segundo&lt;/div&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=9;" parent="1" vertex="1">
          <mxGeometry x="465" y="1030" width="270" height="55" as="geometry" />
        </mxCell>
        <mxCell id="benefits-section" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#000000;strokeColor=#000000;strokeWidth=3;" parent="1" vertex="1">
          <mxGeometry x="70" y="1160" width="710" height="200" as="geometry" />
        </mxCell>
        <mxCell id="benefits-title" value="&lt;b&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;BENEFÃCIOS DA SEPARAÃ‡ÃƒO&lt;/font&gt;&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontColor=#ffffff;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="225" y="1175" width="400" height="30" as="geometry" />
        </mxCell>
        <mxCell id="benefit1-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#000000;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="100" y="1220" width="320" height="60" as="geometry" />
        </mxCell>
        <mxCell id="benefit1-title" value="&lt;b&gt;1. DESACOPLAMENTO&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="120" y="1228" width="280" height="18" as="geometry" />
        </mxCell>
        <mxCell id="benefit1-text" value="AplicaÃ§Ã£o nÃ£o depende do Kafka estar disponÃ­vel.&lt;br&gt;Falhas no Kafka nÃ£o afetam transaÃ§Ãµes de negÃ³cio." style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=9;" parent="1" vertex="1">
          <mxGeometry x="125" y="1245" width="270" height="27" as="geometry" />
        </mxCell>
        <mxCell id="benefit2-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#000000;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="440" y="1220" width="320" height="60" as="geometry" />
        </mxCell>
        <mxCell id="benefit2-title" value="&lt;b&gt;2. ESCALABILIDADE OTIMIZADA&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="460" y="1228" width="280" height="18" as="geometry" />
        </mxCell>
        <mxCell id="benefit2-text" value="Cada componente escala com base em suas mÃ©tricas&lt;br&gt;especÃ­ficas, sem desperdÃ­cio de recursos." style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=9;" parent="1" vertex="1">
          <mxGeometry x="465" y="1244" width="270" height="27" as="geometry" />
        </mxCell>
        <mxCell id="benefit3-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#000000;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="100" y="1290" width="320" height="60" as="geometry" />
        </mxCell>
        <mxCell id="benefit3-title" value="&lt;b&gt;3. RESILIÃŠNCIA&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="120" y="1298" width="280" height="18" as="geometry" />
        </mxCell>
        <mxCell id="benefit3-text" value="Relay pode reprocessar eventos sem afetar app.&lt;br&gt;Retry automÃ¡tico em caso de falha no Kafka." style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=9;" parent="1" vertex="1">
          <mxGeometry x="125" y="1314" width="270" height="27" as="geometry" />
        </mxCell>
        <mxCell id="benefit4-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#000000;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="440" y="1290" width="320" height="60" as="geometry" />
        </mxCell>
        <mxCell id="benefit4-title" value="&lt;b&gt;4. MANUTENIBILIDADE&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="460" y="1298" width="280" height="18" as="geometry" />
        </mxCell>
        <mxCell id="benefit4-text" value="LÃ³gica de publicaÃ§Ã£o isolada facilita testes e mudanÃ§as.&lt;br&gt;Equipes podem trabalhar independentemente." style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=9;" parent="1" vertex="1">
          <mxGeometry x="465" y="1314" width="270" height="27" as="geometry" />
        </mxCell>
        <mxCell id="scenarios-section" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#000000;strokeWidth=3;" parent="1" vertex="1">
          <mxGeometry x="70" y="1400" width="710" height="240" as="geometry" />
        </mxCell>
        <mxCell id="scenarios-title" value="&lt;b&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;CENÃRIOS DE ESCALABILIDADE&lt;/font&gt;&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="250" y="1410" width="350" height="25" as="geometry" />
        </mxCell>
        <mxCell id="scenario1-sep-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#000000;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="100" y="1450" width="320" height="170" as="geometry" />
        </mxCell>
        <mxCell id="scenario1-sep-title" value="&lt;b&gt;CenÃ¡rio 1: Alto TrÃ¡fego HTTP&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="120" y="1460" width="280" height="20" as="geometry" />
        </mxCell>
        <mxCell id="scenario1-sep-desc" value="&lt;b&gt;SituaÃ§Ã£o:&lt;/b&gt; Black Friday, pico de requisiÃ§Ãµes" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="125" y="1485" width="270" height="15" as="geometry" />
        </mxCell>
        <mxCell id="scenario1-sep-before" value="&lt;b&gt;AÃ§Ã£o:&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="125" y="1505" width="270" height="15" as="geometry" />
        </mxCell>
        <mxCell id="scenario1-boxes" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e0e0e0;strokeColor=#000000;strokeWidth=1;" parent="1" vertex="1">
          <mxGeometry x="135" y="1525" width="250" height="35" as="geometry" />
        </mxCell>
        <mxCell id="scenario1-content" value="APP: 3 â†’ 10 instÃ¢ncias â¬†ï¸&lt;br&gt;RELAY: 2 instÃ¢ncias (sem mudanÃ§a)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;" parent="1" vertex="1">
          <mxGeometry x="145" y="1528" width="230" height="30" as="geometry" />
        </mxCell>
        <mxCell id="scenario1-sep-result" value="&lt;b&gt;Resultado:&lt;/b&gt; AplicaÃ§Ã£o lida com carga sem&lt;br&gt;sobrecarregar publicaÃ§Ã£o de eventos." style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="125" y="1570" width="270" height="35" as="geometry" />
        </mxCell>
        <mxCell id="scenario2-sep-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#000000;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="440" y="1450" width="320" height="170" as="geometry" />
        </mxCell>
        <mxCell id="scenario2-sep-title" value="&lt;b&gt;CenÃ¡rio 2: Backlog de Eventos&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="460" y="1460" width="280" height="20" as="geometry" />
        </mxCell>
        <mxCell id="scenario2-sep-desc" value="&lt;b&gt;SituaÃ§Ã£o:&lt;/b&gt; Kafka offline por 1 hora, 100K eventos pendentes" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="465" y="1485" width="270" height="15" as="geometry" />
        </mxCell>
        <mxCell id="scenario2-sep-before" value="&lt;b&gt;AÃ§Ã£o:&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="465" y="1505" width="270" height="15" as="geometry" />
        </mxCell>
        <mxCell id="scenario2-boxes" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e0e0e0;strokeColor=#000000;strokeWidth=1;" parent="1" vertex="1">
          <mxGeometry x="475" y="1525" width="250" height="35" as="geometry" />
        </mxCell>
        <mxCell id="scenario2-content" value="APP: 5 instÃ¢ncias (sem mudanÃ§a)&lt;br&gt;RELAY: 2 â†’ 8 instÃ¢ncias â¬†ï¸" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;" parent="1" vertex="1">
          <mxGeometry x="485" y="1528" width="230" height="30" as="geometry" />
        </mxCell>
        <mxCell id="scenario2-sep-result" value="&lt;b&gt;Resultado:&lt;/b&gt; Backlog processado rapidamente&lt;br&gt;sem afetar performance da aplicaÃ§Ã£o." style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="465" y="1570" width="270" height="35" as="geometry" />
        </mxCell>
        <mxCell id="observability-section" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#000000;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="70" y="1680" width="710" height="180" as="geometry" />
        </mxCell>
        <mxCell id="observability-title" value="&lt;b&gt;MÃ‰TRICAS DE OBSERVABILIDADE&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=13;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="250" y="1690" width="350" height="25" as="geometry" />
        </mxCell>
        <mxCell id="metrics-trans-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#000000;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="100" y="1730" width="320" height="110" as="geometry" />
        </mxCell>
        <mxCell id="metrics-trans-title" value="&lt;b&gt;Processo Transacional&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="120" y="1740" width="280" height="20" as="geometry" />
        </mxCell>
        <mxCell id="metrics-trans-list" value="ðŸ“Š request_latency_ms&lt;br&gt;ðŸ“Š transaction_duration_ms&lt;br&gt;ðŸ“Š database_connection_pool_size&lt;br&gt;ðŸ“Š http_requests_per_second&lt;br&gt;ðŸ“Š business_errors_count" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="125" y="1765" width="270" height="70" as="geometry" />
        </mxCell>
        <mxCell id="metrics-relay-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#000000;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="440" y="1730" width="320" height="110" as="geometry" />
        </mxCell>
        <mxCell id="metrics-relay-title" value="&lt;b&gt;Relay de Eventos&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="460" y="1740" width="280" height="20" as="geometry" />
        </mxCell>
        <mxCell id="metrics-relay-list" value="ðŸ“Š outbox_pending_events_count&lt;br&gt;ðŸ“Š publishing_lag_seconds&lt;br&gt;ðŸ“Š kafka_publish_rate_per_second&lt;br&gt;ðŸ“Š kafka_publish_errors_count&lt;br&gt;ðŸ“Š outbox_oldest_event_age_seconds" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="465" y="1765" width="270" height="70" as="geometry" />
        </mxCell>
        <mxCell id="XcweV8IVql3toKlxGz35-2" value="" style="endArrow=classic;html=1;strokeColor=#ffffff;strokeWidth=3;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" target="read-outbox-box">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="609.76" y="320" as="sourcePoint" />
            <mxPoint x="609.76" y="350" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="XcweV8IVql3toKlxGz35-3" value="" style="endArrow=classic;html=1;strokeColor=#ffffff;strokeWidth=3;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="609.76" y="565" as="sourcePoint" />
            <mxPoint x="609.76" y="595" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="XcweV8IVql3toKlxGz35-4" value="" style="endArrow=classic;html=1;strokeColor=#ffffff;strokeWidth=3;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="609.76" y="700" as="sourcePoint" />
            <mxPoint x="609.76" y="730" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="commit-box" value="&lt;b&gt;COMMIT&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#000000;strokeColor=#000000;strokeWidth=2;fontSize=11;align=center;fontColor=#ffffff;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="120" y="757" width="240" height="10" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
